webpackJsonp([5],{"Kzb+":function(e,i,s){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var r={name:"rolePermission",props:{},data:function(){return{roleId:"",drawerFlag:!1,spinShow:!0,allModuleList:[],multiPermissionList:[],userPermissionList:[],permissionData:[{title:"某某有限公司",expand:!0,children:[]}]}},mounted:function(){},methods:{initData:function(e){var i=this;this.drawerFlag=!0,this.spinShow=!0,this.roleId=e,this.api({url:"",method:"get"}).then(function(e){"00000000"===e.code&&(i.allModuleList=e.data.rows,i.api({url:"",method:"get"}).then(function(e){"00000000"===e.code&&(i.multiPermissionList=e.data.rows,i.api({url:"",method:"get"}).then(function(e){"00000000"===e.code?(i.userPermissionList=e.data.rows,i.initPermissionData()):i.$Message.error(e.message)}))}))})},initPermissionData:function(){var e=this,i=[];this.allModuleList.forEach(function(s){var r={};r.title=s.title,r.expand=!0;var t=[];e.userPermissionList.forEach(function(i){if(i.permissionModuleId===s.id){var r=i.permissionId,a={};a.title=i.permissionTitle,a.expand=!0;var n=!1;e.multiPermissionList.forEach(function(e){e.permissionId===r&&(n=!0)}),a.permissionId=r,a.checked=n,t.push(a)}}),r.children=t,i.push(r)}),this.permissionData[0].children=i,this.spinShow=!1},closeDrawer:function(){this.drawerFlag=!1,this.permissionData=[{title:"",expand:!0,children:[]}]},savePermission:function(){var e=this;if(""!==this.roleId){var i=[];this.$refs.permissionTree.data.forEach(function(e){e.children.forEach(function(e){e.children.forEach(function(e){!0===e.checked&&i.push(e.permissionId)})})});var s=[];i.forEach(function(i){s.push({roleId:e.roleId,permissionId:i})}),batchSavePermission(s).then(function(i){var s=i.data;1001===s.code?(e.$Message.info("保存成功"),e.drawerFlag=!1):e.$Message.error(s.message)}).catch(function(i){e.$Message.error(i)})}else this.$Message.error("请刷新页面重试")}}},t={render:function(){var e=this,i=e.$createElement,s=e._self._c||i;return s("div",[s("Drawer",{attrs:{title:"分配角色权限",closable:!0,"mask-closable":!1},on:{"on-close":e.closeDrawer},model:{value:e.drawerFlag,callback:function(i){e.drawerFlag=i},expression:"drawerFlag"}},[s("Button",{attrs:{size:"small",type:"primary"},on:{click:e.savePermission}},[e._v("保存")]),e._v(" "),s("Button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small"},on:{click:e.closeDrawer}},[e._v("关闭")]),e._v(" "),s("Divider"),e._v(" "),s("Tree",{ref:"permissionTree",attrs:{data:e.permissionData,"show-checkbox":"",multiple:"",scrollable:""}}),e._v(" "),e.spinShow?s("Spin",{attrs:{size:"large",fix:""}}):e._e()],1)],1)},staticRenderFns:[]},a=s("/Xao")(r,t,!1,null,null,null);i.default=a.exports}});